import win32api
import win32gui
import time
import sounddevice as sd
from scipy.io.wavfile import write





op = input('quel type d\'operation veux-tu executer? \n mute\n record\n')

if (op =='mute') : #ici à chaque fois que cette option est lancée elle trigger le micro (Activé -> Désactivé | Désactivé -> Activé)
    WM_APPCOMMAND = 0x319
    APPCOMMAND_MICROPHONE_VOLUME_MUTE = 0x180000
    hwnd_active = win32gui.GetForegroundWindow()
    win32api.SendMessage(hwnd_active, WM_APPCOMMAND, None, APPCOMMAND_MICROPHONE_VOLUME_MUTE)
    print("oeoeo")
else:   #ici à chaque fois que cette option est lancée elle record 10 secondes du micro et met l'extrait audio dans un fichier .wav
    if(op=='record'):
        fs = 44100 #fréquence d'échantillonnage
        sec = 10 #durée de l'enregistrement 

        record = sd.rec(int(sec * fs), samplerate=fs, channels=2)
        sd.wait() 
        write('output.wav', fs, record)
        print("nonononon")
#time.sleep(500)
